---
title: "Untitled"
author: "Matteo Ciciani"
date: "February 25, 2019"
output: beamer_presentation
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

## SEIR: an introduction
Column 1
--------------------------------------------------
\begin{align*}
  \begin{cases}
  S'(t) = \betaN-\frac{c\chi}{N}S(t)I(t)-\muS(t)\\
  E'(t) = \frac{c\chi}{N}S(t)I(t)-(k+\mu)E(t)\\
  I'(t) = kE(t)-(\mu+\gamma) I(t)\\
  R'(t) =\gamma I(t)-\muR(t)
  \end{cases}
\end{align*}

Column 2
--------------------------------------------------
\begin{align}
		\label{s3}
		\begin{cases}
			\dot{u}(\tau) = -R_0u(\tau)u(\tau)w(\tau)+\beta(1-u(\tau))\\
			\dot{v}(\tau) = R_0u(\tau)w(\tau)-(\rho+\beta)v(\tau)\\
			\dot{w}(\tau) = \rho v(\tau)-w(\tau)\\
			\dot{z}(\tau) = w(\tau)-\beta z.
		\end{cases}
	\end{align}


## Simulations

$$
R_0 = \frac{c\chi}{\gamma}
$$


Column 1
--------------------------------------------------

### $$R_0>1+\frac{\beta}{\rho}$$

```{r, echo=FALSE, fig.width=7, fig.height=6,fig.cap="\\label{fig:gen1}Numerical simulation of a SEIR model with $R_0>1$. We can see that the system convergest to the endemic equilibrium."}
source("SEIR_general.R")
ggplot(data = SEIR_out_long, aes(x = time, y = value, colour = variable)) +
  geom_line() + scale_color_discrete(name = "class") +
  myTheme + ylab("E, I, R") +
  scale_y_continuous(sec.axis = sec_axis(trans = ~.*2, name = "S")) + 
  theme(legend.position="bottom", axis.title.y.right =
      element_text(margin = margin(l = 20))) + 
  xlab("time")
```

Column 2
--------------------------------------------------

### $$R_0>1+\frac{\beta}{\rho}$$
```{r, echo=FALSE, fig.width=7, fig.height=6,fig.cap="\\label{fig:gen2}Numerical simulation of a SEIR model with $R_0<1$. We can see that the system convergest to the disease-free equilibrium."}
source("SEIR_general.R")
ggplot(data = SEIR_out_long2, aes(x = time, y = value, colour = variable)) +
  geom_line() + scale_color_discrete(name = "class") +
  myTheme + ylab("E, I, R") +
  scale_y_continuous(sec.axis = sec_axis(trans = ~.*10, name = "S")) + 
  theme(legend.position="bottom", axis.title.y.right =
      element_text(margin = margin(l = 20))) + 
  xlab("time")
```

## SEIR for rabies epidemic
\begin{align*}
\begin{cases}
S_d'(t) = A + \lambda_dR_d + \sigma_d (1 - \gamma_d )E_d - \beta_d S_dI_d - (m_d + k_d)S_d\\
E_d'(t) = \beta_d S_dI_d - \sigma_d (1 - \gamma_d )E_d - \sigma_d\gamma_d E_d - (m_d + k_d)E_d\\
I_d'(t) = \sigma_d\gamma_d E_d - (m_d + \mu_d)I_d\\
R_d'(t) = k(S_d + E_d) - (m_d + \lambda_d)R_d\\
S_h'(t) = B + \lambda_hR_h + \sigma_h(1 - \gamma_h )E_h - m_hS_h - \beta_{dh}S_hI_h\\
E_h'(t) = \beta_{dh}S_hI_d - \sigma_h(1 - \gamma_h )E_h - \sigma_h\gamma_hE_h - (m_h + k_h )E_h\\
I_h'(t) = \sigma_h\gamma_hE_h - (m_h + \mu_h)I_h\\\
R_h'(t) = k_hE_h - (m_h + \lambda_h )R_h
\end{cases}
\end{align*}

##
```{r, echo=FALSE, fig.width=7, fig.height=6,fig.cap="\\label{fig:dh1}Numerical simulations of rabies cases in China from 1996, for a period of 50 years. $S(t)$ and $R(t)$ are plotted in log$_{10}$ scale. The curve for $I(t)$ reproduces Fig. 2.2b of \\cite{Cina}."}
library(latex2exp)
source("SEIR_dogs_humans.R")
# ggplot(data = as.data.frame(SEIR_out)) +
#   geom_line(mapping = aes(time, I_h), color = "red") + myTheme + 
#   ylab(TeX("$I_h$")) + xlab("time (months)")
ggplot(data = SEIR_out_long, aes(x = time, y = value, colour = variable)) +
  geom_line() + scale_color_discrete(name = "class") +
  myTheme + ylab(latex2exp::TeX("$E_h$, $I_h$")) +
  scale_y_continuous(sec.axis = sec_axis(trans = ~., name =
    latex2exp::TeX("$S_h$, $R_h$"),
    breaks = breaks, labels = labels)) + theme(legend.position="bottom",
      axis.title.y.right = element_text(margin = margin(l = 20))) + 
  xlab("time (months)")
```

##
```{r, echo=FALSE, fig.width=7, fig.height=6, fig.cap="\\label{fig:dh2}Number of human rabies cases $I_h(t)$ for different initial values of the susceptible dog population $S_d(0)$. This plot reproduces Fig. 2.3a of \\cite{Cina}."}
ggplot(data = I_h_df_long, aes(x = time, y = value, colour = variable)) +
  geom_line() + scale_color_discrete(name = latex2exp::TeX("$S_d(0)$")) +
  myTheme + ylab(TeX("$I_h$")) + theme(legend.position="bottom") + xlab("time (months)") +
  xlim(0, 1000)
```
##
```{r, echo=FALSE, fig.width=7, fig.height=6, fig.cap="\\label{fig:dh3}Number of human rabies cases $I_h(t)$ for different initial values of the susceptible human population $S_h(0)$. This plot reproduces Fig. 2.3b of \\cite{Cina}."}
ggplot(data = I_h_df_long_2, aes(x = time, y = value, colour = variable)) +
  geom_line() + scale_color_discrete(name = latex2exp::TeX("$S_h(0)$")) +
  myTheme + ylab(TeX("$I_h$")) + theme(legend.position="bottom") + xlab("time (months)") +
  xlim(0, 1000)
```

## SEIV: a distinction between domestic and stray
\begingroup
\setlength{\mathindent}{0pt}
\begin{align}
	\label{s4}
	\begin{cases}
		S_0'(t) = lS_1 - (\mu + c)S_0 - \beta_0S_0I_0 + p_0E_0 + \delta_1V_0\\
		E_0'(t) = lE_1 + \beta_0S_0I_0 - (\mu + c + \sigma_0 + p_0)E_0\\
		I_0'(t) = \sigma_0E_0 + \epsilon I_1 - (\mu + c + \alpha)I_0\\
		V_0'(t) = lV_1 - (\mu + c + \delta_1)V_0\\
		S_1'(t) = A - \beta S_1I_0 - \beta_1S_1I_1 - (1 + \nu + l)S_1 + p_1E_1 + \delta2V_1\\
		E_1'(t) = \beta S_1I_0 + \beta_1S_1I_1 - (1 + \nu + \sigma_1 + l + p_1)E_1\\
		I_1'(t) = \sigma_1E_1 - (1 + \epsilon + k)I_1\\
		V_1'(t) = \nu(S_1 + E_1) - (1 + l + \delta_2)V_1\\
		S_h'(t) = H - \mu_hS_h - \lambda_{1h}S_hI_0 - \lambda_{2h}S_hI_1 + \delta_{1h}Eh + \delta_{2h}V_h\\
		E_h'(t) =\lambda_{1h}S_hI_0 + \lambda_{2h}S_hI_1 - (\mu_h + \sigma_h + \delta_{1h} + \nu_h)E_h\\
		I_h'(t) = \sigma_hE_h - (\mu_h + \alpha_h )I_h\\
		V_h'(t) = \nu_hE_h - (\mu_h + \delta_{2h})V_h\\
	\end{cases}
\end{align}
\endgroup

##
```{r, echo=FALSE, fig.width=7, fig.height=6, fig.cap="\\label{fig:dsh1}Simulation of human rabies infection cases from 2006 to 2014 for the Guangdong Province of China. This plot reproduces Fig. 3.2 of \\cite{Cina}."}
source("SEIR_dogs_stray_humans.R")
ggplot(data = as.data.frame(SEIR_out)) +
  geom_line(mapping = aes(time, I_h), color = "red") + myTheme +
  ylab(TeX("$I_h$")) + xlab("time (months)") + xlim(0, 100)
```
##
```{r, echo=FALSE, fig.width=7, fig.height=6, fig.cap="\\label{fig:dsh2}Numerical simulations of rabies cases in the Guangdong Province from 2006 to 2014. $S(t)$ and $V(t)$ are plotted in log$_{10}$ scale."}
ggplot(data = SEIR_out_long, aes(x = time, y = value, colour = variable)) +
  geom_line() + scale_color_discrete(name = "class") +
  myTheme + ylab(latex2exp::TeX("$E_h$, $I_h$")) +
  scale_y_continuous(sec.axis = sec_axis(trans = ~., name =
      latex2exp::TeX("$S_h$, $V_h$"),
    breaks = breaks, labels = labels)) + theme(legend.position="bottom",
      axis.title.y.right = element_text(margin = margin(l = 20))) + 
  xlab("time (months)")
```

##

```{r, echo=FALSE, fig.width=7, fig.height=6, fig.cap="\\label{fig:dsh3}Simulations of infected human rabies cases $I_h(t)$ in the Guangdong Province for different values of $l$ and $\\epsilon$. This plot reproduces Fig. 3.5a of \\cite{Cina}."}
ggplot(data = I_h_df_long_1, aes(x = time, y = value, colour = variable)) +
  geom_line() + scale_color_discrete(name = TeX("$l$, $\\epsilon$"), labels = labels_1) +
  myTheme + ylab(TeX("$I_h$")) + theme(legend.position="bottom") + xlab("time (months)") + xlim(0, 125)
```
##
```{r, echo=FALSE, fig.width=7, fig.height=6, fig.cap="\\label{fig:dsh4}Simulations of infected human rabies cases $I_h(t)$ in the Guangdong Province for different values of $c$ and $\\nu$. This plot reproduces Fig. 3.5b of \\cite{Cina}."}
ggplot(data = I_h_df_long_2, aes(x = time, y = value, colour = variable)) +
  geom_line() + scale_color_discrete(name = "", labels = c(
    "No intervention", "50% stray dog culling", "100% stray dog culling",
    "50% vaccination", "70% vaccination")) +
  myTheme + ylab(TeX("$I_h$")) + theme(legend.position="bottom") + 
  xlab("time (months)") + guides(col = guide_legend(nrow = 3)) + xlim(0, 125)
```
##
```{r, echo=FALSE, fig.width=7, fig.height=6, fig.cap="\\label{fig:dsh5}Simulations of infected human rabies cases $I_h(t)$ in the Guangdong Province for different values of $\\nu_h$. This plot should reproduces Fig. 3.5c of \\cite{Cina}, but is quite different."}
ggplot(data = I_h_df_long_3, aes(x = time, y = value, colour = variable)) +
  geom_line() + scale_color_discrete(name = TeX("$\\nu_h$"), labels = nu_h_vect) +
  myTheme + ylab(TeX("$I_h$")) + theme(legend.position="bottom") + 
  xlab("time (months)") + xlim(0, 125)
```


## SEIR: a seasonal model
\begingroup
\setlength{\mathindent}{0pt}
\begin{align}
\label{s5}
\begin{cases}
S_d'(t) = A + \lambda_dR_d + \sigma_d (1 - \gamma_d )E_d - \beta_d(t) S_dI_d - (m_d + k_d)S_d\\
E_d'(t) = \beta_d(t) S_dI_d - \sigma_d (1 - \gamma_d )E_d - \sigma_d\gamma_d E_d - (m_d + k_d)E_d\\
I_d'(t) = \sigma_d\gamma_d E_d - (m_d + \mu_d)I_d\\
R_d'(t) = k(S_d + E_d) - (m_d + \lambda_d)R_d\\
S_h'(t) = B + \lambda_hR_h + \sigma_h(1 - \gamma_h )E_h - m_hS_h - \beta_{dh}(t)S_hI_h\\
E_h'(t) = \beta_{dh}(t)S_hI_d - \sigma_h(1 - \gamma_h )E_h - \sigma_h\gamma_hE_h - (m_h + k_h )E_h\\
I_h'(t) = \sigma_h\gamma_hE_h - (m_h + \mu_h)I_h\\\
R_h'(t) = k_hE_h - (m_h + \lambda_h )R_h
\end{align}
\endgroup

##
```{r, echo=FALSE, fig.width=7, fig.height=6, fig.cap="\\label{fig:s1}Simulation of human rabies infection cases in China from 2004, for a period of 12.5 years. This plot reproduces Fig. 4.2a of \\cite{Cina}."}
source("SEIR_seasonal.R")
ggplot(data = as.data.frame(SEIR_out)) +
  geom_line(mapping = aes(time, I_h), color = "red") + myTheme + 
  ylab(TeX("$I_h$")) + xlab("time (months)")
```
##
```{r, echo=FALSE, fig.width=7, fig.height=6, fig.cap="\\label{fig:s2}Numerical simulations of human rabies cases in China from 2004, for a period of 12.5 years. $S(t)$ and $R(t)$ are plotted in log$_{10}$ scale."}
ggplot(data = SEIR_out_long, aes(x = time, y = value, colour = variable)) +
  geom_line() + scale_color_discrete(name = "class") +
  myTheme + ylab(latex2exp::TeX("$E_h$, $I_h$")) +
  scale_y_continuous(sec.axis = sec_axis(trans = ~., name =
      latex2exp::TeX("$S_h$, $R_h$"),
    breaks = breaks, labels = labels)) + theme(legend.position="bottom",
      axis.title.y.right = element_text(margin = margin(l = 20))) + 
  xlab("time (months)")
```
##
```{r, echo=FALSE, fig.width=7, fig.height=6, fig.cap="\\label{fig:s3}Simulation of human rabies infection cases in China from 2004, for a period of 125 years. This plot reproduces Fig. 4.2b of \\cite{Cina}."}
ggplot(data = as.data.frame(SEIR_out_2)) +
  geom_line(mapping = aes(time, I_h), color = "red") + myTheme + 
  ylab(TeX("$I_h$")) + xlab("time (months)")
```
##
```{r, echo=FALSE, fig.width=7, fig.height=6, fig.cap="\\label{fig:s4}Number of human rabies cases $I_h(t)$ for different initial values of the susceptible dog population $S_d(0)$. This plot reproduces Fig. 4.3a of \\cite{Cina}."}
ggplot(data = I_h_df_long_1, aes(x = time, y = value, colour = variable)) +
  geom_line() + scale_color_discrete(name = TeX("$S_d(0)$")) +
  myTheme + ylab(TeX("$I_h$")) + theme(legend.position="bottom") + 
  xlab("time (months)") + guides(col = guide_legend(nrow = 2))
```
##
```{r, echo=FALSE, fig.width=7, fig.height=6, fig.cap="\\label{fig:s5}Number of human rabies cases $I_h(t)$ for different initial values of the infectious dog population $I_d(0)$. This plot reproduces Fig. 4.3b of \\cite{Cina}."}
ggplot(data = I_h_df_long_2, aes(x = time, y = value, colour = variable)) +
  geom_line() + scale_color_discrete(name = TeX("$I_d(0)$")) +
  myTheme + ylab(TeX("$I_h$")) + theme(legend.position="bottom") + 
  xlab("time (months)")
```

## SEIV: multi-patches model
\begingroup
\small
\setlength{\mathindent}{0pt}
\begin{align}
	\label{s6}
	\begin{cases}
	S_{d,i}'(t) = & A_i + \lambda_{d,i}V_{d,i} + \sigma_{d,i} (1 - \gamma_{d,i})E_{d,i} - \beta_{d,i}S_{d,i}I_{d,i} +\\
	& - (m_{d,i} + k_{d,i})S_{d,i}+\sum_{j=1}^n\Phi^S_{ij}S_{d,j}\\
	E_{d,i}'(t) = & \beta_{d,i}  S_{d,i}I_{d,i} - \sigma_{d,i} (1 - \gamma_{d,i}
	)E_{d,i} - \sigma_{d,i}\gamma_{d,i} E_{d,i} +\\
	& - (m_{d,i} + k_{d,i})E_{d,i}+\sum_{j=1}^n\Phi^E_{ij}E_{d,j}\\
	I_{d,i}'(t) = & \sigma_{d,i}\gamma_{d,i} E_{d,i} - (m_{d,i} +
	\mu_{d,i})I_{d,i}+\sum_{j=1}^n\Phi^I_{ij}I_{d,j}\\
	V_{d,i}'(t) =& k_{d,i}(S_{d,i} + E_{d,i}) - (m_{d,i} + \lambda_{d,i})V_{d,i}
	+\sum_{j=1}^n\Phi^V_{ij}V_{d,j}\\
	S_{h,i}'(t) =& B + \lambda_{h,i}V_{h,i} + \sigma_{h,i}(1 - \gamma_{h,i} )E_{h,i}
	- m_{h,i}S_{h,i} +\\
	& - \beta_{dh,i}S_{h,i}I_{d,i}+\sum_{j=1}^n\Psi^S_{ij}S_{h,j}\\
	E_{h,i}'(t) =& \beta_{dh,i} S_{h,i}I_{d,i} - \sigma_{h,i}(1 - \gamma_{h,i}
	)E_{h,i} - \sigma_{h,i}\gamma_{h,i}E_{h,i} +\\
	& - (m_{h,i} + k_{h,i} )E_{h,i}	+\sum_{j=1}^n\Psi^E_{ij}E_{h,j}\\
	I_{h,i}'(t) =& \sigma_{h,i}\gamma_{h,i}E_{h,i} - (m_{h,i} + \mu_{h,i})I_{h,i} +
	\sum_{j=1}^n\Psi^I_{ij}I_{h,j}\\
	V_{h,i}'(t) =& k_{h,i}E_{h,i} - (m_{h,i} + \lambda_{h,i}
	)V_{h,i}+\sum_{j=1}^n\Psi^V_{ij}V_{h,j}\\
	\end{cases}
\end{align}
\endgroup

##
```{r, echo=FALSE, fig.width=7, fig.height=6, fig.cap="\\label{fig:p1}Simulations of the numbers of reported human rabies cases in Hebei and Fujian from 2004 to 2012. This plot attempts to reproduces Fig. 6.3 of \\cite{Cina}, using plausible values of the initial conditions."}
source("SEIV_patch.R")
ggplot(data = out, aes(x = time, y = value, colour = variable)) +
  geom_line() + scale_color_discrete(name = "Province", labels =
      c("Hebei", "Fujian")) +
  myTheme + ylab(TeX("$I_h$")) + theme(legend.position="bottom") + 
  xlab("time (months)") + xlim(0, 100)
```


## SEIV: multi-patches with domestic and stray dogs
\begingroup
\small
\setlength{\mathindent}{0pt}
\begin{align}
	\label{s6}
	\begin{cases}
  S_{s,i}'(t) = & A_{s,i} + \lambda_{s,i}V_{s,i} + \sigma_{s,i} (1 - \gamma_{s,i})E_{s,i} - \beta_{ss,i}S_{s,i}I_{s,i} +\\
	& - \beta_{ds,i}S_{s,i}I_{d,i} - (m_{s,i} + k_{s,i})S_{s,i}+\sum_{j=1}^nP^S_{ij}S_{s,j} + lS_{d,i}\\
	E_{s,i}'(t) = & \beta_{ds,i}  S_{s,i}I_{d,i} + \beta_{ss,i}  S_{s,i}I_{s,i} + lE_{d,i} - \sigma_{s,i} (1 - \gamma_{s,i}
	)E_{s,i} \\
	& - \sigma_{s,i}\gamma_{s,i} E_{s,i} - (m_{s,i} + k_{s,i})E_{s,i}+\sum_{j=1}^nP^E_{ij}E_{s,j} \\
	I_{s,i}'(t) = & \sigma_{s,i}\gamma_{s,i} E_{s,i} - (m_{s,i} +
	\mu_{s,i})I_{s,i}+\sum_{j=1}^nP^I_{ij}I_{s,j} + \epsilon I_{d,i}\\
	V_{s,i}'(t) =& k_{s,i}(S_{s,i} + E_{s,i}) - (m_{s,i} + \lambda_{s,i})V_{s,i} +\sum_{j=1}^nP^V_{ij}V_{s,j} + lI_{d,i}\\
	S_{d,i}'(t) = & A_{d,i} + \lambda_{d,i}V_{d,i} + \sigma_{d,i} (1 - \gamma_{d,i})E_{d,i} - \beta_{dd,i}S_{d,i}I_{d,i} +\\
	& -\beta_{ds,i}S_{d,i}I_{s,i} - (m_{d,i} + k_{d,i})S_{d,i}+\sum_{j=1}^n\Phi^S_{ij}S_{d,j} -  lS_{d,i}\\
	E_{d,i}'(t) = & \beta_{dd,i}  S_{d,i}I_{d,i} + \beta_{ds,i}  S_{d,i}I_{s,i} - lE_{d,i} - \sigma_{d,i} (1 - \gamma_{d,i}
	)E_{d,i} +\\
	& - \sigma_{d,i}\gamma_{d,i} E_{d,i} - (m_{d,i} + k_{d,i})E_{d,i}+\sum_{j=1}^n\Phi^E_{ij}E_{d,j}\\
	I_{d,i}'(t) = & \sigma_{d,i}\gamma_{d,i} E_{d,i} - (m_{d,i} +
	\mu_{d,i})I_{d,i}+\sum_{j=1}^n\Phi^I_{ij}I_{d,j} - \epsilon I_{d,i}\\
	V_{d,i}'(t) =& k_{d,i}(S_{d,i} + E_{d,i}) - (m_{d,i} + \lambda_{d,i})V_{d,i} +\sum_{j=1}^n\Phi^V_{ij}V_{d,j} -  lI_{d,i}\\
	S_{h,i}'(t) =& B + \lambda_{h,i}V_{h,i} + \sigma_{h,i}(1 - \gamma_{h,i} )E_{h,i}
	- m_{h,i}S_{h,i} +\\
	& - \beta_{hd,i}S_{h,i}I_{d,i} - \beta_{hs,i}S_{h,i}I_{s,i} + \sum_{j=1}^n\Psi^S_{ij}S_{h,j}\\
	E_{h,i}'(t) =& \beta_{dh,i} S_{h,i}I_{d,i} - \sigma_{h,i}(1 - \gamma_{h,i}
	)E_{h,i} - \sigma_{h,i}\gamma_{h,i}E_{h,i} +\\
	& - (m_{h,i} + k_{h,i} )E_{h,i}	+\sum_{j=1}^n\Psi^E_{ij}E_{h,j}\\
	I_{h,i}'(t) =& \sigma_{h,i}\gamma_{h,i}E_{h,i} - (m_{h,i} + \mu_{h,i})I_{h,i} +
	\sum_{j=1}^n\Psi^I_{ij}I_{h,j}\\
	V_{h,i}'(t) =& k_{h,i}E_{h,i} - (m_{h,i} + \lambda_{h,i}
	)V_{h,i}+\sum_{j=1}^n\Psi^V_{ij}V_{h,j}\\
	\end{cases}
\end{align}
\endgroup

##
```{r, include=FALSE}
wdgt <- DiagrammeR::grViz("patch_SEIV.gv")
wdgt_html_tf <- tempfile(fileext = ".html")
htmlwidgets::saveWidget(wdgt, wdgt_html_tf)
webshot::webshot(url = sprintf("file://%s", wdgt_html_tf), 
  selector = "#htmlwidget_container",
  file = "patch_SEIV.pdf")
unlink(wdgt_html_tf)
```
\begin{figure*}[!htb]
  \centering
  \includegraphics[width=\textwidth,trim = 4cm 7.1cm 2.5cm 1.2cm, clip]{patch_SEIV.pdf}
  \caption{Flow chart of the SEIV model with stray and domestic dogs. The
  meaning of parameters is identical to the multi-patch model presentes in
  \cite{Cina}. Additional parameters not present in that model are: the
  transmission rated between the different classes $\beta_{dd}$, $\beta_{ds}$,
  $\beta_{ss}$, $\beta_{hd}$, $\beta_{hs}$; the abandonment rates of infectious
  and non-infectious domestic dogs $\epsilon$ and $l$, respectively; the travel
  rate matrices of stray dogs $P^J$, $J=S,E,I,V$.}
  \label{fig:mess}
\end{figure*}

##
```{r, echo=FALSE, fig.width=7, fig.height=6, fig.cap="\\label{fig:ps1}Numerical simulation of the number of exposed and infectious humand in the Hebei and Fujian provinces for the multi-patch SEIV model with stray dogs."}
source("SEIV_patch_stray.R")
ggplot(data = SEIR_out_long, aes(x = time, y = value, colour = variable)) +
  geom_line() + scale_color_discrete(name = "class", labels =
    c("E_h_Hebei", "E_h_Fujian", "I_h_Hebei", "I_h_Fujian")) +
  myTheme + ylab(latex2exp::TeX("$E_h$, $I_h$")) +
   theme(legend.position="bottom", axis.title.y.right =
    element_text(margin = margin(l = 20))) + 
  xlab("time (months)")
```



##SEIR: multi-patches with domestic and stray dogs and seasonal components
The new transmission rate are:
-$$\beta_{dd}(t)=a_{dd}[1 + b_{dd}sin( \frac{\pi}{6} t + 5.5)]$$
-$$\beta_{ss}(t)=\beta_{ds}(t)=a_s[1 + b_ssin( \frac{\pi}{6} t + 5.5)]$$
-$$\beta_{hd}(t)=\beta_{hs}(t)=a_h[1 + b_hsin( \frac{\pi}{6} t + 5.5)]$$

##
```{r, echo=FALSE, fig.width=7, fig.height=6, fig.cap="\\label{fig:pss1}Numerical simulation of the number of exposed and infectious humand in the Hebei and Fujian provinces for the multi-patch SEIV model with stray dogs and seasonal transmission rates."}
source("SEIV_patch_stray_seasonal.R")
ggplot(data = SEIR_out_long, aes(x = time, y = value, colour = variable)) +
  geom_line() + scale_color_discrete(name = "class", labels =
    c("E_h_Hebei", "E_h_Fujian", "I_h_Hebei", "I_h_Fujian")) +
  myTheme + ylab(latex2exp::TeX("$E_h$, $I_h$")) +
   theme(legend.position="bottom", axis.title.y.right =
    element_text(margin = margin(l = 20))) + 
  xlab("time (months)")
```

### Culling rate of stray dogs


```{r, echo=FALSE, fig.width=7, fig.height=6, fig.cap="\\label{fig:cull}Numerical simulation of the number of human rabies cases in the Hebei province for different values of the culling rate of stray dogs."}
ggplot(data = I_h_1_df_cull_long, aes(x = time, y = value, colour = variable)) +
  geom_line() + scale_color_discrete(name = "Culling rate",
    labels = c("0", "0.2", "0.4", "0.655")) +
  myTheme + ylab(TeX("$I_{h, Hebei}$")) + theme(legend.position="bottom") + 
  xlab("time (months)")
```

### Birth rate of stray dogs

```{r, echo=FALSE, fig.width=7, fig.height=6, fig.cap="\\label{fig:birth}Numerical simulation of the number of human rabies cases in the Hebei province for different values of the birth rate of stray dogs."}
ggplot(data = I_h_1_df_birth_long, aes(x = time, y = value, colour = variable)) +
  geom_line() + scale_color_discrete(name = "birth rate multiplier",
    labels = c("1", "0.5", "0.2", "0.1")) +
  myTheme + ylab(TeX("$I_{h, Hebei}$")) + theme(legend.position="bottom") + 
  xlab("time (months)")
```

### Vaccination rate of dogs


```{r, echo=FALSE, fig.width=7, fig.height=6, fig.cap="\\label{fig:vax}Numerical simulation of the number of human rabies cases in the Hebei province for different values of the vaccination rate of stray and domestic dogs."}
ggplot(data = I_h_1_df_vax_long, aes(x = time, y = value, colour = variable)) +
  geom_line() + scale_color_discrete(name = "vaccination rate") +
  myTheme + ylab(TeX("$I_{h, Hebei}$")) + theme(legend.position="bottom") + 
  xlab("time (months)")
```

### Effect of a dual immunocontraceptive vaccine
```{r, echo=FALSE, fig.width=7, fig.height=6, fig.cap="\\label{fig:cull}plotting example"}
ggplot(data = I_h_1_df_gnrh_long, aes(x = time, y = value, colour = variable)) +
  geom_line() + scale_color_discrete(name = "birth rate multiplier,\nvaccination rate",
    labels = c("1, 0.1", "2/3, 0.2", "2/3, 0.3", "1/2, 0.4")) +
  myTheme + ylab(TeX("$I_{h, Hebei}$")) + theme(legend.position="bottom") + 
  xlab("time (months)") + guides(col = guide_legend(nrow = 2))
```

